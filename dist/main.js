(()=>{"use strict";var e=document.querySelector(".game__button-reset"),t=document.querySelector(".game__field"),n=document.querySelector(".game__button-start"),o=document.querySelector(".popup"),c=document.querySelector(".table__body"),l=document.querySelector(".popup__button-open"),r=document.querySelector(".popup__button-close"),s=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],a=0,i=!1,u=function(){return++a},d=function(){var e=JSON.parse(localStorage.getItem("allResults"));null===e&&(e=[]),10===e.length?(e.unshift({winner:arguments.length<=0?void 0:arguments[0],steps:arguments.length<=1?void 0:arguments[1]}),e.pop()):e.unshift({winner:arguments.length<=0?void 0:arguments[0],steps:arguments.length<=1?void 0:arguments[1]}),localStorage.setItem("allResults",JSON.stringify(e))},m=function(e,t){var n=function(e,t){var n=document.querySelector(".table__template").content.cloneNode(!0);return n.querySelector(".table__data:nth-child(1)").textContent=++t,n.querySelector(".table__data:nth-child(2)").textContent=e.winner,n.querySelector(".table__data:nth-child(3)").textContent=e.steps,n}(e,t);c.appendChild(n)},_=function(){var e=JSON.parse(localStorage.getItem("allResults"));null!==e&&e.forEach(m)};_();var p=function(n){var o=document.querySelectorAll(".game__field-cell");a>4&&s.map((function(c){o[c[0]].classList.contains(n)&&o[c[1]].classList.contains(n)&&o[c[2]].classList.contains(n)&&(o[c[0]].classList.add("win"),o[c[1]].classList.add("win"),o[c[2]].classList.add("win"),t.removeEventListener("click",v),i=!0,function(t){document.querySelectorAll(".empty").forEach((function(e){return e.classList.remove("empty")}));var n="cross"===t?"Крестик":"Нолик";document.querySelector(".game__title").textContent="".concat(n," выиграл"),document.querySelector(".game__text").textContent="Всего ходов: ".concat(a),e.classList.add("visible"),d(n,a),document.querySelectorAll(".table__row_data").forEach((function(e){return e.remove()})),_()}(n))})),9!==a||i||(document.querySelector(".game__title").textContent="Ничья",document.querySelector(".game__text").textContent="Всего ходов: ".concat(a),e.classList.add("visible"),d("Ничья",a))},v=function(e){e.target.classList.contains("game__field-cell")&&a%2==0&&(e.target.classList.add("cross"),e.target.classList.remove("empty"),u(),p("cross"),setTimeout((function(){return function(){var e=document.querySelectorAll(".empty");if(!i&&0!==e.length){var t=Math.floor(Math.random()*e.length);e[t].classList.add("zero"),e[t].classList.remove("empty"),u(),p("zero")}}()}),50))};e.addEventListener("click",(function(){document.querySelectorAll(".game__field-cell").forEach((function(t){t.classList.remove("cross"),t.classList.remove("zero"),t.classList.remove("win"),t.classList.add("empty"),e.classList.remove("visible")})),document.querySelector(".game__title").textContent="",document.querySelector(".game__text").textContent="",a=0,i=!1,t.addEventListener("click",v)})),n.addEventListener("click",(function(){n.remove(),document.querySelector(".game").classList.add("visible")})),t.addEventListener("click",v),l.addEventListener("click",(function(){var e;e=JSON.parse(localStorage.getItem("allResults")),document.querySelector(".popup__title").textContent=null===e?"Игры еще не было":"Результаты",o.classList.add("popup_open")})),r.addEventListener("click",(function(){o.classList.remove("popup_open")}))})();